# 拋出異常之前先將物件恢復為有效狀態

拋出異常之後不代表異常處理就結束了，還必須將物件狀態回復至異常發生之前的樣子。

以「ATM轉帳」為例子，

(A)小王轉帳給小李，小王先扣了100元，

(B)接著這100元進到小李的帳戶。

如果在(B)的時候發生錯誤，小李沒有收到錢，但此時程式又沒有物件(小王的帳戶)回復轉帳之前，於是小王的100元就白白蒸發了。

所以要有 commit-rollback 的機制。

----

每當撰寫可能引發異常的程式碼時，有3點要注意：

1. 異常發生之時
2. 異常處理過後
3. 重跑這段程式碼時會發生甚麼事情？程式碼還能運轉正常嗎？

另外還要注意，將「狀態回復的程式碼」是否也可能發生異常？